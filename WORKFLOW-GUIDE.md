# å·¥ä½œæµä½¿ç”¨æŒ‡å—

## ç»Ÿä¸€å·¥ä½œæµæ¦‚è¿°

é¡¹ç›®ç°åœ¨ä½¿ç”¨å•ä¸ªç»Ÿä¸€çš„å·¥ä½œæµ `.github/workflows/build-and-test.yml`ï¼Œå®ƒæ ¹æ®è§¦å‘æ¡ä»¶è‡ªåŠ¨å†³å®šæ‰§è¡Œæ¨¡å¼ï¼š

### è§¦å‘æ–¹å¼

#### 1. è‡ªåŠ¨è§¦å‘ï¼ˆæ„å»ºå’Œæµ‹è¯•ï¼‰
- **æ¨é€åˆ°ä¸»åˆ†æ”¯**: `main`, `master`, `develop`
- **Pull Request**: é’ˆå¯¹ `main`, `master` åˆ†æ”¯
- **æ‰§è¡Œå†…å®¹**: ä¸‹è½½åŸç”Ÿåº“ â†’ è·¨å¹³å°æµ‹è¯• â†’ æ„å»ºJAR â†’ é›†æˆæµ‹è¯•

#### 2. æ ‡ç­¾è§¦å‘ï¼ˆå‘å¸ƒæ¨¡å¼ï¼‰
- **æ¨é€ v* æ ‡ç­¾**: ä¾‹å¦‚ `git tag v1.0.0 && git push origin v1.0.0`
- **æ‰§è¡Œå†…å®¹**: å®Œæ•´æ„å»ºæµ‹è¯• â†’ åˆ›å»ºGitHub Release

#### 3. æ‰‹åŠ¨è§¦å‘
- **è®¿é—®**: GitHubä»“åº“ â†’ Actions â†’ "Build, Test and Release" â†’ Run workflow
- **å‚æ•°**:
  - `release_version`: å‘å¸ƒç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ `v1.0.0`ï¼‰
  - ç•™ç©º = ä»…æ„å»ºæµ‹è¯•
  - å¡«å†™ = åˆ›å»ºå‘å¸ƒ

### ä½¿ç”¨åœºæ™¯

#### ğŸ“¦ ä»…æ„å»ºå’Œæµ‹è¯•
```bash
# æ‰‹åŠ¨è§¦å‘ï¼Œä¸å¡«å†™ release_version
# æˆ–è€…æ¨é€ä»£ç åˆ°ä¸»åˆ†æ”¯
git push origin main
```

#### ğŸš€ åˆ›å»ºå‘å¸ƒ
```bash
# æ–¹å¼1: æ¨é€æ ‡ç­¾ï¼ˆæ¨èï¼‰
git tag v1.0.0
git push origin v1.0.0

# æ–¹å¼2: æ‰‹åŠ¨è§¦å‘ï¼Œå¡«å†™ release_version = "v1.0.0"
```

### å·¥ä½œæµè¯¦ç»†æ­¥éª¤

#### æ ‡å‡†æ¨¡å¼ï¼ˆæ„å»º+æµ‹è¯•ï¼‰
1. **check-release**: æ£€æŸ¥æ˜¯å¦ä¸ºå‘å¸ƒæ¨¡å¼
2. **download-native-libs**: ä¸‹è½½fast-imageåŸç”Ÿåº“
3. **test-cross-platform**: åœ¨å¤šå¹³å°æµ‹è¯•ï¼ˆUbuntu, Windows, macOSï¼‰
4. **build-jar**: æ„å»ºJARåŒ…
5. **integration-test**: é›†æˆæµ‹è¯•

#### å‘å¸ƒæ¨¡å¼ï¼ˆæ ‡å‡†æ¨¡å¼ + å‘å¸ƒï¼‰
1. æ‰§è¡Œæ‰€æœ‰æ ‡å‡†æ­¥éª¤
2. **build-jar**: é¢å¤–æ„å»ºsources.jarå’Œjavadoc.jar
3. **test-release**: åœ¨å¤šå¹³å°æµ‹è¯•å‘å¸ƒåŒ…
4. **create-release**: åˆ›å»ºGitHub Release

### å‘å¸ƒåŒ…å†…å®¹

å‘å¸ƒæ—¶ä¼šåˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š
- `fast-image-java-{version}.jar` - ä¸»åº“ï¼ˆåŒ…å«åŸç”Ÿä¾èµ–ï¼‰
- `fast-image-java-{version}-sources.jar` - æºä»£ç 
- `fast-image-java-{version}-javadoc.jar` - APIæ–‡æ¡£

### æ”¯æŒçš„å¹³å°

- **Windows**: x86_64, aarch64
- **Linux**: x86_64, aarch64  
- **macOS**: x86_64 (Intel), aarch64 (Apple Silicon)

### å›¾ç‰‡æ ¼å¼å¤„ç†

åº“éµå¾ª**æ ¼å¼ä¿æŒåŸåˆ™**ï¼š
- PNGè¾“å…¥ â†’ PNGè¾“å‡º
- JPEGè¾“å…¥ â†’ JPEGè¾“å‡º

### ç¤ºä¾‹

#### å¼€å‘é˜¶æ®µæµ‹è¯•
```bash
git add .
git commit -m "Add new feature"
git push origin main
# è‡ªåŠ¨è§¦å‘æ„å»ºå’Œæµ‹è¯•
```

#### å‘å¸ƒæ–°ç‰ˆæœ¬
```bash
# ç¡®ä¿ä»£ç å·²æäº¤
git add .
git commit -m "Release v1.2.0"

# åˆ›å»ºå¹¶æ¨é€æ ‡ç­¾
git tag v1.2.0
git push origin v1.2.0
# è‡ªåŠ¨åˆ›å»ºå‘å¸ƒ
```

#### ç´§æ€¥æ‰‹åŠ¨å‘å¸ƒ
1. è®¿é—® GitHub Actions
2. é€‰æ‹© "Build, Test and Release"
3. ç‚¹å‡» "Run workflow"
4. å¡«å†™ `release_version`: `v1.2.1`
5. ç‚¹å‡» "Run workflow"

### å·¥ä½œæµçŠ¶æ€æ£€æŸ¥

å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ£€æŸ¥å·¥ä½œæµçŠ¶æ€ï¼š
- GitHubä»“åº“ â†’ Actions æ ‡ç­¾
- æ¯ä¸ªcommitçš„çŠ¶æ€æ£€æŸ¥
- Pull Requestçš„æ£€æŸ¥çŠ¶æ€

### æ•…éšœæ’é™¤

å¦‚æœå·¥ä½œæµå¤±è´¥ï¼š
1. æ£€æŸ¥Actionsé¡µé¢çš„è¯¦ç»†æ—¥å¿—
2. éªŒè¯åŸç”Ÿåº“ç‰ˆæœ¬ `FAST_IMAGE_VERSION` æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤ä»£ç ç¼–è¯‘é€šè¿‡
4. æ£€æŸ¥æµ‹è¯•æ˜¯å¦éƒ½èƒ½é€šè¿‡
